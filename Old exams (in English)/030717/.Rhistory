par(mfrow = c(2,1))
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = 0.45, type = '-', col = 'red')
x11()
par(mfrow = c(2,1))
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = 0.46, type = '-', col = 'red')
x11()
par(mfrow = c(2,1))
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = 0.47, type = '-', col = 'red')
x11()
par(mfrow = c(2,1))
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = 0.47, type = '-', col = 'red')
abline(h = 0.3, type = '--', col = 'red')
x11()
par(mfrow = c(2,1))
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = 0.47, type = '-', col = 'red')
abline(h = 0.2, type = '--', col = 'red')
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = 0.47, type = '-', col = 'red')
abline(h = 0.21, type = '--', col = 'red')
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = 0.47, type = '-', col = 'red')
abline(h = 0.21, type = '--', col = 'red')
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = 0.47, type = '-', col = 'red')
abline(h = 0.21, type = '--', col = 'red')
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = 0.47, type = '-', col = 'red')
abline(h = 0.21, type = '-', col = 'red')
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = 0.47, type = '.', col = 'red')
abline(h = 0.21, type = '.', col = 'red')
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = 0.47, col = 'red')
abline(h = 0.21 , col = 'red')
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = 0.47, col = 'red')
abline(h = 0.22 , col = 'red')
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = 0.46, col = 'red')
abline(h = 0.22 , col = 'red')
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = 0.465, col = 'red')
abline(h = 0.22 , col = 'red')
histo_resp ~ meanmax
summary(histo_resp ~ meanmax)
newdat$histo_resp
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = max(newdat$histo_resp), col = 'red')
abline(h = min(newdat$histo_resp) , col = 'red')
abline(h = min(newdat$histo_resp) , col = 'red', type = 't')
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = max(newdat$histo_resp), col = 'red')
abline(h = min(newdat$histo_resp) , col = 'red', type = 't')
help(abline)
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = max(newdat$histo_resp), col = 'red')
abline(h = min(newdat$histo_resp) , col = 'red')
newdat
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = max(newdat$histo_resp), col = 'red')
text(newdat[100,1],newdat[100,2], "0.4632615", col = 'red')
abline(h = min(newdat$histo_resp) , col = 'red')
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = max(newdat$histo_resp), col = 'red')
text(newdat[100,1],0.5, "0.4632615", col = 'red')
abline(h = min(newdat$histo_resp) , col = 'red')
par(mfrow = c(2,1))
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = max(newdat$histo_resp), col = 'red')
text(newdat[100,1],0.5, "0.4632615", col = 'red')
abline(h = min(newdat$histo_resp) , col = 'red')
text(newdat[1,1],0.2, "0.2226549", col = 'red')
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = max(newdat$histo_resp), col = 'red')
text(newdat[100,1],0.5, "0.4632615", col = 'red')
abline(h = min(newdat$histo_resp) , col = 'red')
text(newdat[1,1],0.2, "0.2226549", col = 'red')
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = max(newdat$histo_resp), col = 'red')
text(newdat[100,1],0.5, "0.4632615", col = 'red')
abline(h = min(newdat$histo_resp) , col = 'red')
text(newdat[1,1],0.2, "0.2226549", col = 'red')
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = max(newdat$histo_resp), col = 'red')
text(newdat[100,1],0.5, "0.4632615", col = 'red')
abline(h = min(newdat$histo_resp) , col = 'red')
text(newdat[1,1],0.2, "0.2226549", col = 'red')
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = max(newdat$histo_resp), col = 'red')
text(newdat[100,1],0.5, "0.4632615", col = 'red')
abline(h = min(newdat$histo_resp) , col = 'red')
text(newdat[1,1],0.2, "0.2226549", col = 'red')
dev.off()
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = max(newdat$histo_resp), col = 'red')
text(newdat[100,1],0.5, "0.4632615", col = 'red')
abline(h = min(newdat$histo_resp) , col = 'red')
text(newdat[1,1],0.2, "0.2226549", col = 'red')
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = max(newdat$histo_resp), col = 'red')
text(newdat[100,1],0.5, "0.4632615", col = 'red')
abline(h = min(newdat$histo_resp) , col = 'red')
text(newdat[1,1],0.2, "0.2226549", col = 'red')
#Differentiating treatments
x11()
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = max(newdat$histo_resp), col = 'red')
text(newdat[100,1],0.5, "0.4632615", col = 'red')
abline(h = min(newdat$histo_resp) , col = 'red')
text(newdat[1,1],0.2, "0.2226549", col = 'red')
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = max(newdat$histo_resp), col = 'red')
text(newdat[95,1],0.5, "0.4632615", col = 'red')
abline(h = min(newdat$histo_resp) , col = 'red')
text(newdat[5,1],0.2, "0.2226549", col = 'red')
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = max(newdat$histo_resp), col = 'red')
text(newdat[95,1],0.5, "0.4632615", col = 'red')
abline(h = min(newdat$histo_resp) , col = 'red')
text(newdat[5,1],0.2, "0.2226549", col = 'red')
x11()
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = max(newdat$histo_resp), col = 'red')
text(newdat[95,1],0.5, "0.4632615", col = 'red')
abline(h = min(newdat$histo_resp) , col = 'red')
text(newdat[5,1],0.2, "0.2226549", col = 'red')
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = max(newdat$histo_resp), col = 'red')
text(newdat[50,1],0.5, "0.4632615", col = 'red')
abline(h = min(newdat$histo_resp) , col = 'red')
text(newdat[50,1],0.2, "0.2226549", col = 'red')
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$kltrt, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = max(newdat$histo_resp), col = 'red')
text(newdat[50,1],0.5, "0.4632615", col = 'red')
abline(h = min(newdat$histo_resp) , col = 'red')
text(newdat[50,1],0.2, "0.2226549", col = 'red')
x11()
df <- DF
df <- df[which(df$cycno == 3 & df$trt == 'Reg-C'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$kltrt, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
abline(h = max(newdat$histo_resp), col = 'red')
text(newdat[50,1],0.5, "0.4632615", col = 'red')
abline(h = min(newdat$histo_resp) , col = 'red')
text(newdat[50,1],0.2, "0.2226549", col = 'red')
#No differentiating treatments
x11()
df <- DF
df <- df[which((df$cycno == 3 & df$trt == 'Reg-C') | (df$cycno == 4 & df$trt == 'Reg-DI')),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$kltrt, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
#########################################################
View(DF)
View(DF)
View(DF)
help(save)
save(DF, file = "BigMamaframe.RData")
dim(DF)
save(DF, file = "BigMamaframe.RData")
save(DF, file = "BigMamaframes.RData")
save(DF, file = "BigMamaframe.RData")
df <- DF
df <- df[which(df$cycno == 4 & df$trt == 'Reg-DI'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$klsex, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
newdat
#No differentiating treatments
x11()
df <- DF
df <- df[which((df$cycno == 3 & df$trt == 'Reg-C') | (df$cycno == 4 & df$trt == 'Reg-DI')),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
newdat <- data.frame(meanmax=seq(min(df$meanmax), max(df$meanmax),len=100))
newdat$histo_resp = predict(fit, newdata=newdat, type="response")
plot(histo_resp~meanmax, data=df, col=df$kltrt, pch = 16)
lines(histo_resp ~ meanmax, newdat, col="green4", lwd=2)
newdat
x11()
par(mfrow = c(3,2))
for(cyc in 1:6){
df <- DF
df <- df[which(df$cycno == cyc),]
fit = glm(trtfact ~ totox, data=df, family=binomial)
newdat <- data.frame(totox=seq(min(df$totox), max(df$totox),len=100))
newdat$trtfact = predict(fit, newdata=newdat, type="response")
plot(trtfact~totox, data=df, col=df$klsex, pch = 16)
lines(trtfact ~ totox, newdat, col="green4", lwd=2)
}
summary(fit)
summary(newdat)
newdat
fit$fitted.values
cyc
df <- DF
df <- df[which(df$cycno == cyc),]
fit = glm(trtfact ~ totox, data=df, family=binomial)
df
fit$fitted.values
dim(fitted.values())
dim(fit$fitted.values
)
length(fit$fitted.values)
length(df[which(df$cycno == 6),])
dim(df[which(df$cycno == 6),])
length(df[which(df$cycno == 6),]$trtfact)
df <- DF
df <- df[which((df$cycno == 3 & df$trt == 'Reg-C') | (df$cycno == 4 & df$trt == 'Reg-DI')),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
summary(fit)
PseudoR2(fit)
roc_curve <- roc(df$histo_resp,fit$fitted.values,
smoothed = FALSE,
plot=TRUE, auc.polygon=TRUE, max.auc.polygon=TRUE, grid=TRUE,
print.auc=TRUE, show.thres=TRUE)
df$histo_resp
fit$fitted.values
df <- DF
df <- na.omit(df)
df <- df[which(df$cycno == 4 & df$trt == 'Reg-DI'),]
fit = glm(histo_resp ~ meanmax, data=df, family=binomial)
summary(fit)
```{r}
#install.packages("e1071")
library('e1071')
#install.packages('caTools')
library(caTools)
#help(svm)
```
#install.packages("e1071")
library('e1071')
#install.packages('caTools')
library(caTools)
#help(svm)
dat <- subset(DF, select = c('cycno','rRDI_cumdose', 'meanmax','histo_resp'))
dat <- dat[which(dat$cycno == 4),-1]
dat<-na.omit(dat)
set.seed(124)
split = sample.split(dat$death, SplitRatio = 0.8)
dat
dat <- subset(DF, select = c('cycno','rRDI_cumdose', 'meanmax','histo_resp'))
dat <- dat[which(dat$cycno == 4),-1]
dat<-na.omit(dat)
set.seed(124)
split = sample.split(dat$histo_resp SplitRatio = 0.8)
dat <- subset(DF, select = c('cycno','rRDI_cumdose', 'meanmax','histo_resp'))
dat <- dat[which(dat$cycno == 4),-1]
dat<-na.omit(dat)
set.seed(124)
split = sample.split(dat$histo_resp, SplitRatio = 0.8)
training_set = subset(dat, split == TRUE)
test_set = subset(dat, split == FALSE)
training_set[-3] = scale(training_set[-3])
test_set[-3] = scale(test_set[-3])
classifier = svm(formula = death ~ .,
data = training_set,
type = 'C-classification',
kernel = 'linear')
install.packages('StatPerMeCo')
plot(classifier, training_set)
help(svm)
library('e1071')
#install.packages('caTools')
library(caTools)
help(svm)
View(surgery_fup)
View(chemo_tox)
help(setwd)
setwd('C:\Users\gianm\Desktop\Applied Statistics\OldExams')
setwd('C:\Users\gianm\Desktop\Applied Statistics\OldExams')
setwd("C:/Users/gianm/Desktop/TDEApplied/Old exams (in English)/030717")
setwd("~/")
df <- read.table("kimono.txt")
setwd("C:/Users/gianm/Desktop/TDEApplied/Old exams (in English)/030717")
df <- read.table("kimono.txt")
head(df)
anova(lm(value ~ type + city + type:city, data = df))
a <- anova(lm(value ~ type + city + type:city, data = df))
linearHypothesis(a, c(0,1,0),0)
library(car)
shapiro.test(tokyo)
shapiro.test(kyoto)
head(df)
a <- anova(lm(value ~ type + city + type:city, data = df))
anova(lm(value ~ type + city, data = df))
tokyo <- df[which(df$city == 'Tokyo'),1]
kyoto <- df[which(df$city == 'Kyoto'),1]
hm <- df[which(df$type == 'hand-made'),1]
rtu <- df[which(df$type == 'ready-to-use'),1]
shapiro.test(tokyo)
shapiro.test(kyoto) # ipotesi non verificate
shapiro.test(hm) # ok
shapiro.test(rtu) # ce lo facciamo andare bene
qqnorm(rtu)
qqline(rtu)
bartlett.test(df$value , df$type)
var.test(hm,rtu) # l'ipotesi sulle varianze Ã¨ accettabile
mcshapiro.test <- function (X, devstmax = 0.01, sim = ceiling(1/(4 * devstmax^2)))
{
library(mvtnorm)
library(mvnormtest)
n <- dim(X)[1]
p <- dim(X)[2]
mu <- rep(0, p)
sig <- diag(p)
W <- NULL
for (i in 1:sim) {
Xsim <- rmvnorm(n, mu, sig)
W <- c(W, mshapiro.test(t(Xsim))$stat)
}
Wmin <- mshapiro.test(t(X))$stat
pvalue <- sum(W < Wmin)/sim
devst <- sqrt(pvalue * (1 - pvalue)/sim)
list(Wmin = as.vector(Wmin), pvalue = pvalue, devst = devst,
sim = sim)
}
library(car)
df <- read.table('bento.txt')
mcshapiro.test(df[,1:4])
mcshapiro.test(df[,5:8])
